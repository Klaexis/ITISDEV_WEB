<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard</title>

  <!-- BOOTSTRAP 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />

  <!-- FONT AWESOME -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- APEX CHART CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.53.0/apexcharts.min.css"
    integrity="sha512-w3pXofOHrtYzBYpJwC6TzPH6SxD6HLAbT/rffdkA759nCQvYi5AHy5trNWFboZnj4xtdyK0AFMBtck9eTmwybg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- LOCAL CSS -->
  <link rel="stylesheet" href="assets/css/global.css" />
  <link rel="stylesheet" href="assets/css/sidebar.css" />
  <link rel="stylesheet" href="assets/css/main.css" />

  <style>
  .table-hover tbody tr:hover td, .table-hover tbody tr:hover th {
    background-color: gray;
    cursor: pointer;
  }

  </style>

  
</head>

<body>
  <!-- SIDEBAR -->
  <%- include('./staples/sidebar.ejs') %>

  <!-- MAIN -->
  <main class="main position-absolute overflow-hidden">
    <!-- TOP CONTENT -->
    <div class="topbar px-3 py-2 bg-success text-white">
      <div class="d-flex justify-content-between align-items-center">
        <div class="toggle position-relative">
          <i class="fa-solid fa-bars text-light"></i>
        </div>
        <!-- User Info -->
        <div class="d-flex align-items-center info-user gap-2">
          <div class="dropdown">
            <a class="user-profile bg-light rounded-circle d-flex align-items-center justify-content-center" href="#"
              role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fa-solid fa-user fs-4"></i>
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
              <li>
                <a class="dropdown-item logout-btn" href="#" data-bs-toggle="modal" data-bs-target="#logout">Logout</a>
              </li>
              <hr class="m-0" />
              <li>
                <a class="dropdown-item text-secondary" href="#">Made by Crocodilo</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="container d-flex align-items-center justify-content-center p-0 mt-3">
        <div class="title text-center w-lg-50 w-md-75 w-sm-100">
          <h1 class="m-0 fw-bold barangay-name text-white">Disaster Readiness and Risk Reduction Application</h1>
          <h4 class="text-white">ITISDEV Group 2</h4>
        </div>
      </div>
    </div>

    <!-- MAIN CONTENT-->
    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="false" style="height: 80dvh;">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active"
          aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1"
          aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2"
          aria-label="Slide 3"></button>
          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3"
          aria-label="Slide 4"></button>
          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="4"
          aria-label="Slide 5"></button>
      </div>
      <div class="carousel-inner h-100">
        <div class="carousel-item active h-100">
          <img src="assets/images/1.jfif" class="d-block w-100 h-100" alt="..." />
          <div class="carousel-caption d-none d-md-block">
            <h5>Welcome to the Disaster Readiness and Risk Reduction Application</h5>
            <p>
              Dedicated in ensuring the safety of the residents.
            </p>
          </div>
        </div>
        <div class="carousel-item h-100">
          <img src="assets//images/2.jfif" class="d-block w-100 h-100" alt="..." />
          <div class="carousel-caption d-none d-md-block">
            <h5>Second slide label</h5>
            <p>
              Some representative placeholder content for the second slide.
            </p>
          </div>
        </div>
        <div class="carousel-item h-100">
          <img src="assets//images/3.jfif" class="d-block w-100 h-100" alt="..." />
          <div class="carousel-caption d-none d-md-block">
            <h5>Third slide label</h5>
            <p>
              Some representative placeholder content for the third slide.
            </p>
          </div>
        </div>
        <div class="carousel-item h-100">
          <img src="assets//images/4.jfif" class="d-block w-100 h-100" alt="..." />
          <div class="carousel-caption d-none d-md-block">
            <h5>Fourth slide label</h5>
            <p>
              Some representative placeholder content for the third slide.
            </p>
          </div>
        </div>
        <div class="carousel-item h-100">
          <img src="assets//images/5.jfif" class="d-block w-100 h-100" alt="..." />
          <div class="carousel-caption d-none d-md-block">
            <h5>Fifth slide label</h5>
            <p>
              Some representative placeholder content for the third slide.
            </p>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"
        data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"
        data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>

    <div class="container-fluid px-lg-5 px-md-3 px-sm-2 mt-5 main-content pb-4 position-relative">
    <!-- MID CONTENT -->
    <h5 class="fw-bold">DASHBOARD OVERVIEW</h5>
    <div class="row gy-3">
        <div class="col-lg-6 col-sm-12">
            <div class="row gy-3">
                <div class="col-12">
                    <div class="dashboard-container bg-dark rounded">
                        <div class="calendar-wrapper">
                            <div class="wrapper">
                                <header>
                                    <div class="icons d-flex justify-content-between align-items-center w-100">
                                        <span id="prev"><i class="fa-solid fa-chevron-left"></i></span>
                                        <p class="current-date m-0 text-white"></p>
                                        <span id="next"><i class="fa-solid fa-chevron-right"></i></span>
                                    </div>
                                </header>
                                <div class="calendar">
                                    <ul class="weeks">
                                        <li>Sun</li>
                                        <li>Mon</li>
                                        <li>Tue</li>
                                        <li>Wed</li>
                                        <li>Thu</li>
                                        <li>Fri</li>
                                        <li>Sat</li>
                                    </ul>
                                    <ul class="days"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12">
                    <div class="dashboard-table rounded bg-dark p-3">
                        <div class="d-flex align-items-center justify-content-between flex-wrap gap-3 mb-3">
                            <label class="text-white fw-bold" for="">RECENT SOS REPORTS</label>
                            <a href="/sos" class="badge text-bg-warning text-decoration-none">See more</a>
                        </div>
                        <div class="table-responsive rounded recently-table table-hover">
                            <table class="table table-borderless text-white">
                                <thead class="thead-light">
                                    <tr>
                                        <th>Name</th>
                                        <th>Date Reported</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if (sos) { %>
                                        <tr>
                                            <td><%= sos.fullName %></td>
                                            <td><%= sos.dateLastSent %></td>
                                        </tr>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="2">No SOS cases found.</td>
                                        </tr>
                                    <% } %>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="col-12">
                    <div class="dashboard-table rounded bg-dark p-3">
                        <div class="d-flex align-items-center justify-content-between flex-wrap gap-3 mb-3">
                            <label class="text-white fw-bold" for="">RECENT MISSING REPORTS</label>
                            <a href="/mia" class="badge text-bg-warning text-decoration-none">See more</a>
                        </div>
                        <div class="table-responsive rounded recently-table">
                            <table class="table table-borderless text-white table-hover">
                                <thead class="thead-light">
                                    <tr>
                                        <th>Name</th>
                                        <th>Date Reported</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if (mia) { %>
                                        <tr>
                                            <td><%= mia.missingFullName %></td>
                                            <td><%= mia.dateSubmitted %></td>
                                        </tr>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="2">No MIA cases found.</td>
                                        </tr>
                                    <% } %>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="logout" tabindex="-1" aria-labelledby="logoutLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header border-0 d-flex justify-content-center">
            <h1 class="modal-title fs-5 text-center fw-bold" id="">
              LOGOUT CONFIRMATION
            </h1>
          </div>
          <div class="modal-body">
            Are you sure you want to logout?
          </div>
          <div class="modal-footer">
            <button type="button" class="modal-button" data-bs-dismiss="modal">Close</button>
            <button type="button" class="modal-button important-button" id="logout-btn">Logout</button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>

    document.getElementById('logout-btn').addEventListener('click', function() {
      $.ajax({
        type: 'GET',
        url: '/logout',
        success: function() {
          console.log('Logout successful');
          window.location.href = '/login';
        }
      });
    });
  </script>

  <script src="assets/JS/bootstrap.bundle.min.js"></script>
  <script src="assets/JS/jquery-3.7.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.53.0/apexcharts.min.js"
    integrity="sha512-QbaChpzUJcRVsOFtDhh/VZMuljqvlPRIhIXsvfREDZcdqzIKdNvAhwrgW+flSxtbxK/BFpdX1y5NSO6bSYHlOA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- LOCAL SCRIPT -->
  <script type="module" src="assets/JS/main.js"></script>

</body>

</html>